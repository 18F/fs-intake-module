# Use node 6.11 as the base image
FROM node:6.11.1

# set the workdir as the /app directory
# this dir is mapped to the server directory in the cloned repo
WORKDIR /app

# Make port 8080 available to the world outside this container
EXPOSE 8080

# env vars for VCAP_SERVICES and DATABASE_URL
ENV VCAP_SERVICES={\"user-provided\":[{\"credentials\":{\"MIDDLELAYER_BASE_URL\":\"http://localhost:8080/\",\"MIDDLELAYER_PASSWORD\":\"pass\",\"MIDDLELAYER_USERNAME\":\"user\"},\"label\":\"user-provided\",\"name\":\"middlelayer-service\",\"syslog_drain_url\":\"\",\"tags\":[],\"volume_mounts\":[]}],\"s3\":[{\"credentials\":{\"bucket\":\"bucket_name\",\"access_key_id\":\"\",\"region\":\"us-east-1\",\"secret_access_key\":\"\"}}]} DATABASE_URL=postgresql://postgres:@127.0.0.1:5432/postgres

# startup node with app.es6 when the container launches
CMD ["node", "app.es6"]
